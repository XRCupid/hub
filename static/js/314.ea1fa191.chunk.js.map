{"version":3,"file":"static/js/314.ea1fa191.chunk.js","mappings":"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","sources":["../node_modules/lipsync/src/lipSyncComponent.js","components/GLBModelWithBlendshapes.tsx","hooks/useLipsync.js"],"sourcesContent":["const template = document.createElement(\"template\");\ntemplate.innerHTML = `\n    <style>\n    @layer mouth, tongue, teeth;\n\n    .mouth,\n    .tongue,\n    .teeth {\n        transition: 0.3s ease;\n    }\n\n    [data-letters=\"aei\"] {\n        @layer mouth {\n            &.mouth {\n                position: relative;\n                background-color: #b63c2c;\n                overflow: hidden;\n                inline-size: 80px;\n                block-size: 40px;\n                border-radius: 45% 55% 50% 50% / 0% 0% 100% 100%;\n                transition: border-radius 0.3s ease;\n            }\n        }\n\n        @layer tongue {\n            .tongue {\n                position: absolute;\n                inset-block-end: -5px;\n                inline-size: 30px;\n                block-size: 25px;\n                background-color: #ef7d4a;\n                border-radius: 51% 49% 54% 46% / 34% 39% 61% 66%;\n                transition: border-radius 0.3s ease;\n\n                &.left-part {\n                    inset-inline-start: 20%;\n                }\n\n                &.right-part {\n                    inset-inline-end: 20%;\n                }\n            }\n        }\n\n        @layer teeth {\n            .teeth {\n                position: absolute;\n                inline-size: 70px;\n                block-size: 10px;\n                background-color: #fffffd;\n                inset-inline-start: 5px;\n\n                &.upper-part {\n                    inset-block-start: -2px;\n                    border-radius: 0 0 80px 80px;\n                }\n\n                &.lower-part {\n                    inset-block-end: 0;\n                }\n            }\n        }\n    }\n\n    [data-letters=\"bmp\"] {\n        @layer mouth {\n            &.mouth {\n                position: relative;\n                background-color: #b63c2c;\n                overflow: hidden;\n                inline-size: 80px;\n                block-size: 8px;\n                border-radius: 49% 51% 51% 50% / 45% 44% 56% 55%;\n            }\n        }\n\n        @layer tongue {\n            .tongue {\n                position: absolute;\n                inset-block-end: -40px;\n                inline-size: 30px;\n                block-size: 40px;\n                background-color: #ef7d4a;\n                border-radius: 51% 49% 54% 46% / 34% 39% 61% 66%;\n\n                &.left-part {\n                    inset-inline-start: 20%;\n                }\n\n                &.right-part {\n                    inset-inline-end: 20%;\n                }\n            }\n        }\n\n        @layer teeth {\n            .teeth {\n                position: absolute;\n                inline-size: 80px;\n                block-size: 30px;\n                background-color: #fffffd;\n                inset-inline-start: 0;\n\n                &.upper-part {\n                    inset-block-start: -40px;\n                    border-radius: 0 0 80% 80%;\n                }\n\n                &.lower-part {\n                    inset-block-end: -45px;\n                    border-radius: 0;\n                }\n            }\n        }\n    }\n\n    [data-letters=\"cdgknstxyz\"] {\n        @layer mouth {\n            &.mouth {\n                position: relative;\n                background-color: #b63c2c;\n                overflow: hidden;\n                inline-size: 80px;\n                block-size: 24px;\n                border-radius: 100% 100% 100% 100% / 100% 100% 100% 100%;\n            }\n        }\n\n        @layer tongue {\n            .tongue {\n                position: absolute;\n                inset-block-end: -8px;\n                inline-size: 36px;\n                block-size: 20px;\n                background-color: #ef7d4a;\n                border-radius: 51% 49% 54% 46% / 34% 39% 61% 66%;\n\n                &.left-part {\n                    inset-inline-start: 20%;\n                }\n\n                &.right-part {\n                    inset-inline-end: 20%;\n                }\n            }\n        }\n\n        @layer teeth {\n            .teeth {\n                position: absolute;\n                inline-size: 80px;\n                block-size: 20px;\n                background-color: #fffffd;\n                inset-inline-start: 0;\n\n                &.upper-part {\n                    inset-block-start: -10px;\n                    border-radius: 0 0 80% 80%;\n                }\n\n                &.lower-part {\n                    inset-block-end: -13px;\n                    border-radius: 0;\n                }\n            }\n        }\n    }\n\n    [data-letters=\"chjsh\"] {\n        @layer mouth {\n            &.mouth {\n                position: relative;\n                background-color: #b63c2c;\n                overflow: hidden;\n                inline-size: 80px;\n                block-size: 30px;\n                border-radius: 49% 50% 8% 8% / 87% 87% 10% 11%;\n            }\n        }\n\n        @layer tongue {\n            .tongue {\n                position: absolute;\n                inset-block-end: -10px;\n                inline-size: 30px;\n                block-size: 25px;\n                background-color: #ef7d4a;\n                border-radius: 51% 49% 54% 46% / 34% 39% 61% 66%;\n\n                &.left-part {\n                    inset-inline-start: 20%;\n                }\n\n                &.right-part {\n                    inset-inline-end: 20%;\n                }\n            }\n        }\n\n        @layer teeth {\n            .teeth {\n                position: absolute;\n                inline-size: 80px;\n                block-size: 12px;\n                background-color: #fffffd;\n                inset-inline-start: 0px;\n\n                &.upper-part {\n                    inset-block-start: 0;\n                    border-radius: 50%;\n                }\n\n                &.lower-part {\n                    inset-block-end: -5px;\n                    border-radius: 20px 20px 0 0;\n                }\n            }\n        }\n    }\n\n    [data-letters=\"ee\"] {\n        @layer mouth {\n            &.mouth {\n                position: relative;\n                background-color: #b63c2c;\n                overflow: hidden;\n                inline-size: 80px;\n                block-size: 24px;\n                border-radius: 39% 40% 51% 50% / 9% 9% 91% 91%;\n            }\n        }\n\n        @layer tongue {\n            .tongue {\n                position: absolute;\n                inset-block-end: -8px;\n                inline-size: 30px;\n                block-size: 20px;\n                background-color: #ef7d4a;\n                border-radius: 51% 49% 54% 46% / 34% 39% 61% 66%;\n\n                &.left-part {\n                    inset-inline-start: 20%;\n                }\n\n                &.right-part {\n                    inset-inline-end: 20%;\n                }\n            }\n        }\n\n        @layer teeth {\n            .teeth {\n                position: absolute;\n                inline-size: 80px;\n                block-size: 20px;\n                background-color: #fffffd;\n                inset-inline-start: 0;\n\n                &.upper-part {\n                    inset-block-start: -10px;\n                    border-radius: 0 0 80% 80%;\n                }\n\n                &.lower-part {\n                    inset-block-end: -15px;\n                    border-radius: 0;\n                }\n            }\n        }\n    }\n\n    [data-letters=\"fv\"] {\n        @layer mouth {\n            &.mouth {\n                position: relative;\n                background-color: #b63c2c;\n                overflow: hidden;\n                inline-size: 80px;\n                block-size: 20px;\n                border-radius: 45% 55% 49% 51% / 15% 15% 85% 85%;\n            }\n        }\n\n        @layer tongue {\n            .tongue {\n                position: absolute;\n                inset-block-end: -25px;\n                inline-size: 30px;\n                block-size: 25px;\n                background-color: #ef7d4a;\n                border-radius: 51% 49% 54% 46% / 34% 39% 61% 66%;\n\n                &.left-part {\n                    inset-inline-start: 20%;\n                }\n\n                &.right-part {\n                    inset-inline-end: 20%;\n                }\n            }\n        }\n\n        @layer teeth {\n            .teeth {\n                position: absolute;\n                inline-size: 70px;\n                block-size: 10px;\n                background-color: #fffffd;\n                inset-inline-start: 5px;\n\n                &.upper-part {\n                    inset-block-start: 0;\n                    border-radius: 0 0 80px 80px;\n                }\n\n                &.lower-part {\n                    inset-block-end: -20px;\n                }\n            }\n        }\n    }\n\n    [data-letters=\"l\"] {\n        @layer mouth {\n            &.mouth {\n                position: relative;\n                background-color: #b63c2c;\n                overflow: hidden;\n                inline-size: 80px;\n                block-size: 40px;\n                border-radius: 100% 100% 100% 100% / 100% 100% 100% 100%;\n            }\n        }\n\n        @layer tongue {\n            .tongue {\n                position: absolute;\n                inset-block-end: -2px;\n                inline-size: 32px;\n                block-size: 20px;\n                background-color: #ef7d4a;\n                border-radius: 51% 49% 54% 46% / 34% 39% 61% 66%;\n\n                &.left-part {\n                    inset-inline-start: 20%;\n                }\n\n                &.right-part {\n                    inset-inline-end: 20%;\n                }\n            }\n        }\n\n        @layer teeth {\n            .teeth {\n                position: absolute;\n                inline-size: 70px;\n                block-size: 20px;\n                background-color: #fffffd;\n                inset-inline-start: 5px;\n\n                &.upper-part {\n                    inset-block-start: -2px;\n                    border-radius: 0 0 80% 80%;\n                }\n\n                &.lower-part {\n                    inset-block-end: -10px;\n                    border-radius: 50% 50% 0 0;\n                }\n            }\n        }\n    }\n\n    [data-letters=\"o\"] {\n        @layer mouth {\n            &.mouth {\n                position: relative;\n                background-color: #b63c2c;\n                overflow: hidden;\n                inline-size: 75px;\n                block-size: 80px;\n                border-radius: 49% 51% 51% 50% / 45% 44% 56% 55%;\n            }\n        }\n\n        @layer tongue {\n            .tongue {\n                position: absolute;\n                inset-block-end: -5px;\n                inline-size: 30px;\n                block-size: 40px;\n                background-color: #ef7d4a;\n                border-radius: 51% 49% 54% 46% / 34% 39% 61% 66%;\n\n                &.left-part {\n                    inset-inline-start: 20%;\n                }\n\n                &.right-part {\n                    inset-inline-end: 20%;\n                }\n            }\n        }\n\n        @layer teeth {\n            .teeth {\n                position: absolute;\n                inline-size: 80px;\n                block-size: 30px;\n                background-color: #fffffd;\n                inset-inline-start: 0;\n\n                &.upper-part {\n                    inset-block-start: -10px;\n                    border-radius: 0 0 80% 80%;\n                }\n\n                &.lower-part {\n                    inset-block-end: -15px;\n                    border-radius: 0;\n                }\n            }\n        }\n    }\n\n    [data-letters=\"qw\"] {\n        @layer mouth {\n            &.mouth {\n                position: relative;\n                background-color: #b63c2c;\n                overflow: hidden;\n                inline-size: 85px;\n                block-size: 32px;\n                border-radius: 45% 55% 50% 50% / 10% 10% 100% 100%;\n            }\n        }\n\n        @layer tongue {\n            .tongue {\n                position: absolute;\n                inset-block-end: -10px;\n                inline-size: 30px;\n                block-size: 25px;\n                background-color: #ef7d4a;\n                border-radius: 51% 49% 54% 46% / 34% 39% 61% 66%;\n\n                &.left-part {\n                    inset-inline-start: 20%;\n                }\n\n                &.right-part {\n                    inset-inline-end: 20%;\n                }\n            }\n        }\n\n        @layer teeth {\n            .teeth {\n                position: absolute;\n                inline-size: 85px;\n                block-size: 12px;\n                background-color: #fffffd;\n                inset-inline-start: 0px;\n\n                &.upper-part {\n                    inset-block-start: 0px;\n                    border-radius: 0 0 80px 80px;\n                }\n\n                &.lower-part {\n                    inset-block-end: -12px;\n                }\n            }\n        }\n    }\n\n    [data-letters=\"r\"] {\n        @layer mouth {\n            &.mouth {\n                position: relative;\n                background-color: #b63c2c;\n                overflow: hidden;\n                inline-size: 80px;\n                block-size: 30px;\n                border-radius: 49% 50% 18% 20% / 74% 79% 20% 23%;\n            }\n        }\n\n        @layer tongue {\n            .tongue {\n                position: absolute;\n                inset-block-end: -8px;\n                inline-size: 30px;\n                block-size: 20px;\n                background-color: #ef7d4a;\n                border-radius: 51% 49% 54% 46% / 34% 39% 61% 66%;\n\n                &.left-part {\n                    inset-inline-start: 20%;\n                }\n\n                &.right-part {\n                    inset-inline-end: 20%;\n                }\n            }\n        }\n\n        @layer teeth {\n            .teeth {\n                position: absolute;\n                inline-size: 80px;\n                block-size: 12px;\n                background-color: #fffffd;\n                inset-inline-start: 0px;\n\n                &.upper-part {\n                    inset-block-start: 0;\n                }\n\n                &.lower-part {\n                    inset-block-end: 0;\n                    border-radius: 50% 50% 0 0;\n                }\n            }\n        }\n    }\n\n    [data-letters=\"th\"] {\n        @layer mouth {\n            &.mouth {\n                position: relative;\n                background-color: #b63c2c;\n                overflow: hidden;\n                inline-size: 80px;\n                block-size: 24px;\n                border-radius: 100% 100% 100% 100% / 100% 100% 100% 100%;\n            }\n        }\n\n        @layer tongue {\n            .tongue {\n                position: absolute;\n                inset-block-end: -2px;\n                inline-size: 32px;\n                block-size: 20px;\n                background-color: #ef7d4a;\n                border-radius: 51% 49% 54% 46% / 34% 39% 61% 66%;\n\n                &.left-part {\n                    inset-inline-start: 20%;\n                }\n\n                &.right-part {\n                    inset-inline-end: 20%;\n                }\n            }\n        }\n\n        @layer teeth {\n            .teeth {\n                position: absolute;\n                inline-size: 75px;\n                block-size: 20px;\n                background-color: #fffffd;\n                inset-inline-start: 0px;\n\n                &.upper-part {\n                    inset-block-start: -10px;\n                    border-radius: 0 0 80% 80%;\n                }\n\n                &.lower-part {\n                    inset-block-end: -10px;\n                    border-radius: 50% 50% 0 0;\n                }\n            }\n        }\n    }\n\n    [data-letters=\"u\"] {\n        @layer mouth {\n            &.mouth {\n                position: relative;\n                background-color: #b63c2c;\n                overflow: hidden;\n                inline-size: 80px;\n                block-size: 30px;\n                border-radius: 49% 50% 18% 20% / 74% 79% 20% 23%;\n            }\n        }\n\n        @layer tongue {\n            .tongue {\n                position: absolute;\n                inset-block-end: -8px;\n                inline-size: 30px;\n                block-size: 20px;\n                background-color: #ef7d4a;\n                border-radius: 51% 49% 54% 46% / 34% 39% 61% 66%;\n\n                &.left-part {\n                    inset-inline-start: 20%;\n                }\n\n                &.right-part {\n                    inset-inline-end: 20%;\n                }\n            }\n        }\n\n        @layer teeth {\n            .teeth {\n                position: absolute;\n                inline-size: 80px;\n                block-size: 12px;\n                background-color: #fffffd;\n                inset-inline-start: 0px;\n\n                &.upper-part {\n                    inset-block-start: 0;\n                }\n\n                &.lower-part {\n                    inset-block-end: -5px;\n                    border-radius: 50%;\n                }\n            }\n        }\n    }\n\n    @layer eye, iris, pupil, light;\n\n    .eyes {\n        display: flex;\n        gap: 20px;\n        justify-content: center;\n        margin: auto;\n    }\n\n    @layer eye {\n        .eye {\n            position: relative;\n            inline-size: 30px;\n            block-size: 40px;\n            margin-block-end: 16px;\n            border-radius: 50%;\n            background-color: #fffffd;\n            overflow: hidden;\n\n            &.left-eye {\n                rotate: -10deg;\n            }\n\n            &.right-eye {\n                rotate: 10deg;\n            }\n        }\n    }\n\n    @layer iris {\n        .iris {\n            position: absolute;\n            inline-size: 26px;\n            block-size: 36px;\n            background-color: #A085CD;\n            border-radius: 50%;\n\n            &.left-iris {\n                inset-inline-end: -2px;\n                inset-block-end: -2px;\n            }\n\n            &.right-iris {\n                inset-inline-start: -2px;\n                inset-block-end: -2px;\n            }\n        }\n    }\n\n    @layer pupil {\n        .pupil {\n            position: absolute;\n            inline-size: 10px;\n            block-size: 15px;\n            background-color: #000;\n            border-radius: 50%;\n\n            &.left-pupil {\n                inset-inline-end: 5px;\n                inset-block-end: 8px;\n                rotate: 15deg;\n            }\n\n            &.right-pupil {\n                inset-inline-start: 5px;\n                inset-block-end: 8px;\n                rotate: -15deg;\n            }\n        }\n    }\n\n    @layer light {\n        .light {\n            position: absolute;\n            inline-size: 6px;\n            block-size: 6px;\n            background-color: #fffffd;\n            border-radius: 50%;\n\n            &.left-light {\n                inset-inline-end: 7px;\n                inset-block-end: 14px;\n            }\n\n            &.right-light {\n                inset-inline-start: 7px;\n                inset-block-end: 14px;\n            }\n        }\n    }\n    </style>    \n    <div class=\"face\">\n        <div class=\"mouth\" data-letters=\"aei\">\n            <div class=\"tongue left-part\"></div>\n            <div class=\"tongue right-part\"></div>\n            <div class=\"teeth upper-part\"></div>\n            <div class=\"teeth lower-part\"></div>\n        </div>\n    </div>\n    `;\n\nclass LipSync extends HTMLElement {\n  constructor() {\n    super();\n    this.attachShadow({ mode: \"open\" });\n    this.shadowRoot.appendChild(template.content.cloneNode(true));\n  }\n  static get observedAttributes() {\n    return [\"data-letters\"];\n  }\n  attributeChangedCallback(name, oldValue, newValue) {\n    if (name === \"data-letters\") {\n      this.shadowRoot.querySelector(\".mouth\").setAttribute(name, newValue);\n    }\n  }\n}\n\ncustomElements.define(\"lip-sync\", LipSync);\n","import React, { useState, useRef, useEffect } from 'react';\nimport { useGLTF } from '@react-three/drei';\n\n\nimport { useLipsync } from '../hooks/useLipsync';\n\nconst PHONEME_TO_BLENDSHAPE: Record<string, string> = {\n  \"AA\": \"jawOpen\",\n  \"AE\": \"jawOpen\",\n  \"AH\": \"jawOpen\",\n  \"AO\": \"jawOpen\",\n  \"EH\": \"mouthSmileLeft\",\n  \"ER\": \"mouthSmileRight\",\n  \"EY\": \"mouthSmileLeft\",\n  \"IH\": \"mouthSmileRight\",\n  \"IY\": \"mouthSmileLeft\",\n  \"OW\": \"mouthFunnel\",\n  \"UH\": \"mouthFunnel\",\n  \"UW\": \"mouthFunnel\",\n  \"B\": \"mouthPressLeft\",\n  \"CH\": \"mouthPressRight\",\n  \"D\": \"mouthPressLeft\",\n  \"F\": \"mouthStretchLeft\",\n  \"G\": \"mouthPressRight\",\n  \"JH\": \"mouthPressLeft\",\n  \"K\": \"mouthPressRight\",\n  \"L\": \"mouthDimpleLeft\",\n  \"M\": \"mouthPressLeft\",\n  \"N\": \"mouthPressRight\",\n  \"P\": \"mouthPressLeft\",\n  \"R\": \"mouthDimpleRight\",\n  \"S\": \"mouthStretchRight\",\n  \"SH\": \"mouthStretchRight\",\n  \"T\": \"mouthPressRight\",\n  \"TH\": \"mouthStretchLeft\",\n  \"V\": \"mouthStretchRight\",\n  \"Z\": \"mouthStretchLeft\",\n  \"ZH\": \"mouthStretchRight\"\n};\n\nconst GLBModelWithBlendshapes = ({ url, audioUrl, blendShapes, position = [0, -1.1, 0], rotation = [0, 0, 0], scale = [1.4, 1.4, 1.4] }: any) => {\n  const gltf: any = useGLTF(url);\n  const scene = gltf.scene;\n  const groupRef = useRef<any>(null);\n\n  // DEBUG: Log all morph target names for each mesh\n  useEffect(() => {\n    if (!scene) return;\n    scene.traverse((child: any) => {\n      if (child.isMesh && child.morphTargetDictionary) {\n        console.log('Mesh:', child.name, 'Morph Targets:', Object.keys(child.morphTargetDictionary));\n      }\n    });\n  }, [scene]);\n\n  // Lipsync state\n  const [currentPhoneme, setCurrentPhoneme] = useState<string | null>(null);\n  useLipsync(audioUrl, setCurrentPhoneme);\n\n  // Scale factor for blendshapes to prevent exaggerated expressions on non-RPM avatars\n  const BLENDSHAPE_SCALE = 0.1;\n\n  useEffect(() => {\n    if (!scene) return;\n    scene.traverse((child: any) => {\n      if (child.isMesh && child.morphTargetDictionary && child.morphTargetInfluences) {\n        const dict = child.morphTargetDictionary;\n        const influences = child.morphTargetInfluences;\n        // Zero all influences\n        Object.keys(dict).forEach(name => {\n          influences[dict[name]] = 0;\n        });\n        // 1. Always apply blendShapes (including blinks) first\n        if (blendShapes) {\n          Object.entries(blendShapes).forEach(([name, value]) => {\n            if (dict[name] !== undefined) {\n              const scaled = Math.max(0, Math.min(1, (value as number) * BLENDSHAPE_SCALE));\n              influences[dict[name]] = scaled;\n            }\n          });\n        }\n        // 2. If lipsync is active, boost the phoneme blendshape (especially jawOpen) for wider mouth opening\n        if (currentPhoneme) {\n          const blendshape = PHONEME_TO_BLENDSHAPE[currentPhoneme];\n          if (blendshape && dict[blendshape] !== undefined) {\n            // Only boost if not a blink\n            if (blendshape !== 'eyeBlinkLeft' && blendshape !== 'eyeBlinkRight') {\n              // Use a higher scale for jawOpen and mouth-related phonemes\n              const phonemeScale = (blendshape === 'jawOpen') ? 0.85 : 0.55;\n              influences[dict[blendshape]] = Math.max(influences[dict[blendshape]], phonemeScale);\n            }\n          }\n        }\n      }\n    });\n  }, [scene, currentPhoneme, blendShapes]);\n\n  return (\n    // @ts-ignore: 'primitive' is provided by @react-three/fiber\n    // @ts-ignore\n    <primitive\n      ref={groupRef}\n      object={scene}\n      scale={scale}\n      position={position}\n      rotation={rotation}\n    />\n  );\n};\n\nexport default GLBModelWithBlendshapes;\n","import { useEffect, useRef, useState } from \"react\";\nimport lipsync from \"lipsync\"; // You must run: npm install lipsync\n\n// Usage: useLipsync(audioUrl, onPhoneme)\nexport function useLipsync(audioUrl, onPhoneme) {\n  const [isPlaying, setIsPlaying] = useState(false);\n  const audioRef = useRef(null);\n\n  useEffect(() => {\n    if (!audioUrl) return;\n    let cancel = false;\n\n    async function processAudio() {\n      // Fetch audio as ArrayBuffer\n      const response = await fetch(audioUrl);\n      const arrayBuffer = await response.arrayBuffer();\n\n      // Use lipsync.js to get phoneme timings\n      const lipsyncData = await lipsync(arrayBuffer);\n\n      // Play audio and animate\n      const audio = new Audio(audioUrl);\n      audioRef.current = audio;\n      setIsPlaying(true);\n\n      audio.play();\n\n      // Animate blendshapes in sync\n      let frame = 0;\n      function animate() {\n        if (cancel || !lipsyncData || !audioRef.current) return;\n        const currentTime = audio.currentTime;\n        // Find the current phoneme\n        const currentPhoneme = lipsyncData.find(\n          (d) => currentTime >= d.start && currentTime < d.end\n        );\n        if (currentPhoneme && onPhoneme) onPhoneme(currentPhoneme.phoneme);\n        if (!audio.paused && !audio.ended) {\n          frame = requestAnimationFrame(animate);\n        } else {\n          setIsPlaying(false);\n        }\n      }\n      animate();\n\n      return () => {\n        cancel = true;\n        if (frame) cancelAnimationFrame(frame);\n        if (audioRef.current) audioRef.current.pause();\n      };\n    }\n\n    processAudio();\n\n    return () => {\n      cancel = true;\n      if (audioRef.current) audioRef.current.pause();\n    };\n  }, [audioUrl, onPhoneme]);\n\n  return { isPlaying, audioRef };\n}\n"],"names":["template","document","createElement","innerHTML","LipSync","HTMLElement","constructor","super","this","attachShadow","mode","shadowRoot","appendChild","content","cloneNode","observedAttributes","attributeChangedCallback","name","oldValue","newValue","querySelector","setAttribute","customElements","define","PHONEME_TO_BLENDSHAPE","_ref","url","audioUrl","blendShapes","position","rotation","scale","scene","useGLTF","groupRef","useRef","useEffect","traverse","child","isMesh","morphTargetDictionary","console","log","Object","keys","currentPhoneme","setCurrentPhoneme","useState","onPhoneme","isPlaying","setIsPlaying","audioRef","cancel","async","response","fetch","arrayBuffer","lipsyncData","lipsync","audio","Audio","current","play","frame","animate","currentTime","find","d","start","end","phoneme","paused","ended","requestAnimationFrame","processAudio","pause","useLipsync","morphTargetInfluences","dict","influences","forEach","entries","_ref2","value","undefined","scaled","Math","max","min","blendshape","phonemeScale","_jsx","ref","object"],"sourceRoot":""}