"use strict";(self.webpackChunkhub=self.webpackChunkhub||[]).push([[5790],{67409:(e,t,o)=>{o.d(t,{l:()=>s});var n=o(212);const i={joy:{mouthSmileLeft:1.2,mouthSmileRight:1.2,cheekSquintLeft:.8,cheekSquintRight:.8,eyeWideLeft:.3,eyeWideRight:.3,browOuterUpLeft:1,browOuterUpRight:1,cheekPuff:.2},sadness:{mouthFrownLeft:1.2,mouthFrownRight:1.2,browInnerUp:1,browDownLeft:.6,browDownRight:.6,eyeLookDownLeft:.4,eyeLookDownRight:.4,mouthLowerDownLeft:.5,mouthLowerDownRight:.5},anger:{browDownLeft:1.2,browDownRight:1.2,browInnerUp:.3,mouthPressLeft:.8,mouthPressRight:.8,eyeSquintLeft:.6,eyeSquintRight:.6,noseSneerLeft:.4,noseSneerRight:.4,mouthUpperUpLeft:.3,mouthUpperUpRight:.3},surprise:{jawOpen:.9,eyeWideLeft:1.2,eyeWideRight:1.2,browOuterUpLeft:1.2,browOuterUpRight:1.2,browInnerUp:.8,mouthFunnel:.3},fear:{mouthStretchLeft:.9,mouthStretchRight:.9,eyeWideLeft:1,eyeWideRight:1,browInnerUp:1,browOuterUpLeft:.7,browOuterUpRight:.7,jawOpen:.4},disgust:{noseSneerLeft:.8,noseSneerRight:.8,mouthUpperUpLeft:.7,mouthUpperUpRight:.7,eyeSquintLeft:.5,eyeSquintRight:.5,browDownLeft:.4,browDownRight:.4},contempt:{mouthSmileLeft:.2,mouthSmileRight:.7,eyeSquintLeft:.3,eyeSquintRight:.6,browDownLeft:.2,browDownRight:.5},excitement:{mouthSmileLeft:1,mouthSmileRight:1,eyeWideLeft:.8,eyeWideRight:.8,browOuterUpLeft:.9,browOuterUpRight:.9,cheekSquintLeft:.6,cheekSquintRight:.6,jawOpen:.3},contentment:{mouthSmileLeft:.4,mouthSmileRight:.4,eyeSquintLeft:.2,eyeSquintRight:.2,browOuterUpLeft:.2,browOuterUpRight:.2},confusion:{browDownLeft:.6,browOuterUpRight:.8,browInnerUp:.4,mouthPucker:.4,eyeSquintLeft:.3,jawOpen:.2},calm:{mouthSmileLeft:.15,mouthSmileRight:.15,eyeSquintLeft:.1,eyeSquintRight:.1},amusement:{mouthSmileLeft:.8,mouthSmileRight:.8,cheekSquintLeft:.7,cheekSquintRight:.7,browOuterUpLeft:.5,browOuterUpRight:.5},concentration:{browDownLeft:.5,browDownRight:.5,browInnerUp:.3,eyeSquintLeft:.4,eyeSquintRight:.4}},s=e=>{console.log("[prosodyToBlendshapes] Received prosodyScore keys:",Object.keys(e).join(", "));const t=n.a.reduce(((e,t)=>(e[t]=0,e)),{});console.log("[prosodyToBlendshapes] Processing emotions...");for(const[o,n]of Object.entries(e)){const e=i[o.toLowerCase()];if(e){console.log("[prosodyToBlendshapes] Processing emotion: ".concat(o,", Score: ").concat(n.toFixed(4)));for(const[o,i]of Object.entries(e)){const e=o,s=t[e]||0,r=n*i*7;t[e]=Math.min(1,Math.max(0,s+r))}}else console.log("[prosodyToBlendshapes] No weights found for emotion: ".concat(o,". Skipping."))}return console.log("[prosodyToBlendshapes] Final combined blendshapes count: ".concat(Object.keys(t).length,", sum of values: ").concat(Object.values(t).reduce(((e,t)=>e+t),0).toFixed(4))),t}},85790:(e,t,o)=>{o.r(t),o.d(t,{HumeRPMIntegration:()=>c});var n=o(9950),i=o(52111),s=o(68057),r=o(64189),h=o(11003),u=o(67409),a=o(44414);function c(e){let{avatarId:t,position:o=[0,-.8,0],scale:c=1.2,showControls:l=!0}=e;const{messages:m,sendSessionSettings:p}=(0,r.c0)(),[g,f]=(0,n.useState)({}),[d,w]=(0,n.useState)({}),[S,L]=(0,n.useState)(!1),R=(0,n.useRef)("");return(0,n.useEffect)((()=>{p({context:{text:"You are a friendly conversational partner in a dating simulation. Be warm, engaging, and responsive."}})}),[p]),(0,n.useEffect)((()=>{var e,t,o,n,i;const s=m[m.length-1];if(!s)return;if("assistant_message"===s.type){var r;const e=null===(r=s.message)||void 0===r?void 0:r.content;e&&e!==R.current&&(R.current=e,console.log("[HumeRPM] Assistant speaking:",e),L(!0))}else"assistant_end"===s.type&&(console.log("[HumeRPM] Assistant finished speaking"),L(!1),w({}));const h=null===(e=s.models)||void 0===e?void 0:e.prosody;if(h&&S){const e=function(e){const t={};if(!e)return t;const{power:o=0,pitch:n=0,speed:i=0}=e;t.jawOpen=Math.min(.8*o,.8),n>.5&&(t.mouthSmileLeft=.3,t.mouthSmileRight=.3),i>.5&&(t.mouthFunnel=.2);const s=.001*Date.now();return t.mouthLeft=.05*Math.sin(3*s),t.mouthRight=.05*Math.cos(3*s),t}(h);w(e)}const a=null===(t=s.models)||void 0===t||null===(o=t.face)||void 0===o||null===(n=o.predictions)||void 0===n||null===(i=n[0])||void 0===i?void 0:i.emotions;if(a){const e=(0,u.l)({emotions:a});f(e)}}),[m,S]),(0,n.useEffect)((()=>{if(!S)return;const e=setInterval((()=>{const e=.001*Date.now(),t=.2+.3*Math.sin(8*e);w({jawOpen:t,mouthFunnel:.2*Math.sin(10*e),mouthPucker:.1*Math.cos(7*e),mouthLeft:.1*Math.sin(5*e),mouthRight:.1*Math.cos(5*e),mouthSmileLeft:.1,mouthSmileRight:.1,mouthStretchLeft:.1*Math.sin(6*e),mouthStretchRight:.1*Math.cos(6*e)})}),50);return()=>clearInterval(e)}),[S]),(0,a.jsxs)("div",{style:{width:"100%",height:"100%"},children:[(0,a.jsxs)(i.Hl,{camera:{position:[0,0,2.5],fov:45},children:[(0,a.jsx)("ambientLight",{intensity:.6}),(0,a.jsx)("directionalLight",{position:[5,5,5],intensity:.5}),(0,a.jsx)("directionalLight",{position:[-5,5,-5],intensity:.3}),(0,a.jsx)(h.RPMAnimatedAvatar,{avatarId:t,emotionShapes:g,visemeShapes:d,isSpeaking:S,position:o,scale:c}),l&&(0,a.jsx)(s.N,{})]}),(0,a.jsxs)("div",{style:{position:"absolute",bottom:10,left:10,background:"rgba(0,0,0,0.7)",color:"white",padding:"10px",borderRadius:"5px",fontSize:"12px"},children:[(0,a.jsxs)("div",{children:["Speaking: ",S?"Yes":"No"]}),(0,a.jsxs)("div",{children:["Jaw Open: ",(d.jawOpen||0).toFixed(2)]}),(0,a.jsxs)("div",{children:["Messages: ",m.length]})]})]})}}}]);