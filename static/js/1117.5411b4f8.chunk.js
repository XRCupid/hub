"use strict";(self.webpackChunkhub=self.webpackChunkhub||[]).push([[1117,2581,6067,6410],{1117:(e,a,t)=>{t.r(a),t.d(a,{RPMAvatar:()=>v,default:()=>b});var r=t(89379),n=t(65043),o=t(79183),s=t(71985),i=t(5355),l=t(50007),c=t(97376),d=t(84718),h=t(29408),m=t(21963),u=(t(86410),t(36067)),p=t(70579);const g={mouthSmile_L:"joy",mouthSmile_R:"joy",cheekSquint_L:"joy",cheekSquint_R:"joy",mouthFrown_L:"sadness",mouthFrown_R:"sadness",browInnerUp:"sadness",browDown_L:"anger",browDown_R:"anger",mouthPress_L:"anger",mouthPress_R:"anger",nostrilDilate_L:"anger",nostrilDilate_R:"anger",eyeWide_L_fear:"fear",eyeWide_R_fear:"fear",browUp_L_fear:"fear",browUp_R_fear:"fear",mouthOpen_fear:"fear",eyeWide_L_surprise:"surprise",eyeWide_R_surprise:"surprise",browUp_L_surprise:"surprise",browUp_R_surprise:"surprise",mouthOpen_surprise:"surprise",noseSneer_L:"disgust",noseSneer_R:"disgust",mouthUpperUp_L:"disgust",mouthUpperUp_R:"disgust",mouthSmile_L_contempt:"contempt",noseSneer_L_contempt:"contempt",mouthSmile_L_excitement:"excitement",mouthSmile_R_excitement:"excitement",eyeWide_L_excitement:"excitement",eyeWide_R_excitement:"excitement",browDown_L_concentration:"concentration",browDown_R_concentration:"concentration",eyeSquint_L:"concentration",eyeSquint_R:"concentration"},f=e=>{let{avatarUrl:a,position:t=[0,0,0],blendShapes:o}=e;const s=n.useMemo((()=>{const e=(a||"default").split("").reduce(((e,a)=>e+a.charCodeAt(0)),0);return(0,u.generateAvatarConfig)({gender:e%2===0?"male":"female",ethnicity:["caucasian","asian","african","hispanic"][e%4],style:["professional","casual","creative","elegant"][e%4],age:e%3===0?"young":"middle"})}),[a]);return(0,p.jsx)(u.ProceduralAvatar,(0,r.A)((0,r.A)({},s),{},{position:t,blendShapes:o}))},y=e=>{let{avatarUrl:a,emotions:t={},isAnimating:r=!1,position:s=[0,0,0],blendShapes:l={}}=e;const c=(0,n.useRef)(null),[m,u]=(0,n.useState)([]),[y,v]=(0,n.useState)(!1),[b,S]=(0,n.useState)(null),[x,R]=(0,n.useState)(0),{actions:_,names:j}=(0,i.f)((null===b||void 0===b?void 0:b.animations)||[],c);return(0,n.useEffect)((()=>{if(!a)return console.log("RPMAvatar: No avatar URL provided, showing fallback"),void v(!0);console.log("RPMAvatar: Attempting to load avatar from:",a);(new d.B).load(a,(e=>{console.log("RPMAvatar: Successfully loaded avatar:",e),S(e),v(!1)}),(e=>{console.log("RPMAvatar: Loading progress:",e)}),(e=>{console.error("RPMAvatar: Failed to load avatar from",a,"Error:",e),v(!0)}))}),[a]),(0,n.useEffect)((()=>{if(b&&b.scene&&b.scene.children){const e=[];b.scene.traverse((a=>{if(a instanceof h.Mesh&&a.morphTargetDictionary){console.log("\ud83c\udfaf Available morph targets:",Object.keys(a.morphTargetDictionary)),e.push(a);const t=a.morphTargetDictionary.mouthSmileLeft,r=a.morphTargetDictionary.mouthSmileRight;void 0!==t&&void 0!==r&&a.morphTargetInfluences&&(a.morphTargetInfluences[t]=.2,a.morphTargetInfluences[r]=.2);const n=a.morphTargetDictionary.eyeBlinkLeft,o=a.morphTargetDictionary.eyeBlinkRight;console.log("\ud83d\udc41\ufe0f Blink morph targets found:",{leftBlink:void 0!==n,rightBlink:void 0!==o})}})),u(e)}}),[b]),(0,n.useEffect)((()=>{if(!b||!c.current)return;(new d.B).load("/animations/Idle.glb",(e=>{if(e.animations.length>0&&c.current){const a=new h.AnimationMixer(c.current);a.clipAction(e.animations[0]).play(),c.current.mixer=a}}),void 0,(e=>{console.log("Could not load idle animation, avatar will remain in T-pose")}))}),[b]),(0,n.useEffect)((()=>{m.length>0&&m.forEach((e=>{e.morphTargetInfluences&&e.morphTargetInfluences.fill(0),Object.entries(t).forEach((a=>{let[t,r]=a;Object.entries(g).forEach((a=>{let[n,o]=a;if(o===t&&void 0!==e.morphTargetDictionary[n]){const a=e.morphTargetDictionary[n];e.morphTargetInfluences&&void 0!==a&&(e.morphTargetInfluences[a]=Math.min(r,1))}}))}))}))}),[t,m]),(0,n.useEffect)((()=>{m.length>0&&m.forEach((e=>{Object.entries(l).forEach((a=>{let[t,r]=a;if(e.morphTargetDictionary&&e.morphTargetInfluences){const a=e.morphTargetDictionary[t];void 0!==a&&(e.morphTargetInfluences[a]=r)}}))}))}),[m,l]),(0,o.F)(((e,a)=>{if(r&&c.current,c.current&&c.current.mixer&&c.current.mixer.update(a),R((e=>e+a)),m.length>0&&x>2&&m.forEach((e=>{if(e.morphTargetDictionary&&e.morphTargetInfluences){const a=e.morphTargetDictionary.eyeBlinkLeft,t=e.morphTargetDictionary.eyeBlinkRight;if(void 0!==a&&void 0!==t){const r=15*(x-2);if(r<1){const n=Math.sin(r*Math.PI);e.morphTargetInfluences[a]=n,e.morphTargetInfluences[t]=n}else e.morphTargetInfluences[a]=0,e.morphTargetInfluences[t]=0,r>1.5&&R(0)}}})),c.current){const a=.01*Math.sin(.5*e.clock.elapsedTime);c.current.scale.y=1+a}})),y||!a?(console.log("\ud83c\udfad Avatar3D: Rendering fallback avatar. loadError:",y,"avatarUrl:",a),(0,p.jsx)(f,{avatarUrl:a,position:s,blendShapes:l})):b?(0,p.jsx)("group",{ref:c,position:s,children:(0,p.jsx)("primitive",{object:b.scene})}):(console.log("\ud83c\udfad Avatar3D: No GLTF loaded yet, returning null"),null)},v=e=>{let{avatarUrl:a,emotions:t={},isAnimating:r=!0,scale:o=1,position:i=[0,-1,0],enableControls:d=!1,className:h="",blendShapes:u={}}=e;const[g,f]=(0,n.useState)(!0),[v,b]=(0,n.useState)(null);return(0,n.useEffect)((()=>{console.log(" RPMAvatar render - URL:",a,"isEmpty:",!a),a||(console.log(" RPM Avatar: No URL provided, showing fallback avatar"),f(!1),m.gr.logSetupInstructions())}),[a]),(0,p.jsxs)("div",{className:"rpm-avatar-container ".concat(h),style:{width:"100%",height:"100%",position:"relative"},children:[g&&(0,p.jsxs)("div",{className:"avatar-loading",children:[(0,p.jsx)("div",{className:"loading-spinner"}),(0,p.jsx)("p",{children:"Loading avatar..."})]}),v&&(0,p.jsxs)("div",{className:"avatar-error",children:[(0,p.jsxs)("p",{children:[" ",v]}),(0,p.jsx)("p",{children:"Using fallback image"})]}),(0,p.jsxs)(s.Hl,{camera:{position:[0,1.6,1.2],fov:30},style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",width:"100%",height:"100%"},gl:{preserveDrawingBuffer:!0,antialias:!0,alpha:!0},onCreated:e=>{console.log("\ud83c\udfa8 Canvas created successfully!",e);const a=e.gl.domElement;a.addEventListener("webglcontextlost",(e=>{console.warn("\ud83d\udea8 WebGL context lost, preventing default"),e.preventDefault()})),a.addEventListener("webglcontextrestored",(()=>{console.log("\u2705 WebGL context restored")})),f(!1)},onError:e=>{console.error("\ud83d\udea8 Canvas error:",e),(e=>{console.error("RPM Avatar loading error:",e),b("Failed to load avatar"),f(!1)})(e)},children:[(0,p.jsx)("ambientLight",{intensity:.5}),(0,p.jsx)("directionalLight",{position:[0,2,3],intensity:1.2}),(0,p.jsx)("pointLight",{position:[-2,1,2],intensity:.8,color:"#ffd700"}),(0,p.jsx)("pointLight",{position:[2,1,2],intensity:.6,color:"#87ceeb"}),(0,p.jsx)(y,{avatarUrl:a,emotions:t,isAnimating:r,position:i,blendShapes:u}),(0,p.jsx)(l.N,{enableZoom:!1,enablePan:!1,enableRotate:!1,target:[0,1.5,0]}),(0,p.jsx)(c.OH,{preset:"studio"})]})]})},b=v},21963:(e,a,t)=>{t.d(a,{du:()=>r,gr:()=>o});const r=[{id:"demo-male-1",name:"Alex",gender:"male",style:"realistic",avatarUrl:"https://models.readyplayer.me/6409c2e6d4bb6b0001b84d5d.glb"},{id:"demo-female-1",name:"Jordan",gender:"female",style:"realistic",avatarUrl:"https://models.readyplayer.me/6409c2e6d4bb6b0001b84d5e.glb"},{id:"demo-female-2",name:"Sam",gender:"female",style:"realistic",avatarUrl:"https://models.readyplayer.me/6409c2e6d4bb6b0001b84d5f.glb"},{id:"demo-male-2",name:"River",gender:"male",style:"realistic",avatarUrl:"https://models.readyplayer.me/6409c2e6d4bb6b0001b84d60.glb"},{id:"haseeb-avatar",name:"Haseeb",gender:"male",style:"realistic",avatarUrl:"/avatars/Haseeb.glb"},{id:"dougie-avatar",name:"Dougie",gender:"male",style:"realistic",avatarUrl:"/avatars/Dougie.glb"}],n="\n\ud83c\udfad HOW TO GET REAL RPM AVATARS:\n\n1. CREATE AVATARS:\n   \u2022 Visit https://readyplayer.me\n   \u2022 Create free avatars for your NPCs\n   \u2022 Copy the .glb URLs (e.g., https://models.readyplayer.me/your-avatar-id.glb)\n\n2. UPDATE AVATAR URLS:\n   \u2022 Replace empty URLs in DEMO_RPM_AVATARS with your real avatar URLs\n   \u2022 Or use the RPMAvatarCreator component to let users input custom URLs\n\n3. CURRENT STATUS:\n   \u2022 Fallback geometric avatars are showing (blue 3D shapes with simple faces)\n   \u2022 These demonstrate the 3D avatar positioning and emotion system\n   \u2022 Replace URLs to see actual RPM avatars with realistic faces and bodies\n\n4. WHERE TO SEE AVATARS:\n   \u2022 Dating Simulation \u2192 Match with someone \u2192 Chat \u2192 Video Date\n   \u2022 The 3D avatar appears in the video call interface\n   \u2022 Emotions change based on conversation (via Hume AI)\n";class o{static getAvatarCreatorUrl(e){const a=new URLSearchParams;null!==e&&void 0!==e&&e.bodyType&&a.set("bodyType",e.bodyType),null!==e&&void 0!==e&&e.quickStart&&a.set("quickStart","true"),null!==e&&void 0!==e&&e.clearCache&&a.set("clearCache","true");const t=a.toString(),r="https://".concat(this.RPM_SUBDOMAIN,".readyplayer.me/avatar");return t?"".concat(r,"?").concat(t):r}static isValidAvatarUrl(e){return/^https:\/\/(models\.readyplayer\.me|d1a370nemizbjq\.cloudfront\.net)\/.+\.glb$/.test(e)}static getRandomDemoAvatar(){const e=r;return e[Math.floor(Math.random()*e.length)]}static getAvatarByName(e){return r.find((a=>a.name.toLowerCase()===e.toLowerCase()))||null}static logSetupInstructions(){console.log(n)}}o.RPM_SUBDOMAIN="demo",o.RPM_API_BASE="https://api.readyplayer.me/v1"},36067:(e,a,t)=>{t.r(a),t.d(a,{ProceduralAvatar:()=>s,generateAvatarConfig:()=>i});var r=t(65043),n=t(79183),o=t(70579);const s=e=>{let{gender:a,skinTone:t,hairColor:s,hairStyle:i,clothingColor:l,position:c=[0,0,0],blendShapes:d={}}=e;const h=(0,r.useRef)(null),m=(0,r.useRef)(null),u=(0,r.useMemo)((()=>{const e={light:"#fdbcb4",medium:"#d4a574",dark:"#8b6f47",pale:"#ffe0bd",tan:"#cd853f"};return e[t]||e.medium}),[t]),p=(0,r.useMemo)((()=>"female"===a?{shoulderWidth:.35,hipWidth:.4,chestSize:.15,waistSize:.3,headSize:.25}:{shoulderWidth:.45,hipWidth:.35,chestSize:.1,waistSize:.35,headSize:.28}),[a]);return(0,n.F)((e=>{h.current&&(h.current.scale.y=1+.01*Math.sin(2*e.clock.elapsedTime),h.current.rotation.y=.05*Math.sin(.5*e.clock.elapsedTime)),m.current&&d&&(d.mouthSmile,d.eyesClosed)})),(0,o.jsxs)("group",{ref:h,position:c,children:[(0,o.jsxs)("mesh",{ref:m,position:[0,1.6,0],children:[(0,o.jsx)("sphereGeometry",{args:[p.headSize,16,16]}),(0,o.jsx)("meshStandardMaterial",{color:u})]}),(0,o.jsxs)("mesh",{position:[-.08,1.65,.2],children:[(0,o.jsx)("sphereGeometry",{args:[.03,8,8]}),(0,o.jsx)("meshStandardMaterial",{color:"#333"})]}),(0,o.jsxs)("mesh",{position:[.08,1.65,.2],children:[(0,o.jsx)("sphereGeometry",{args:[.03,8,8]}),(0,o.jsx)("meshStandardMaterial",{color:"#333"})]}),"bald"!==i&&(0,o.jsxs)("mesh",{position:[0,1.75,0],children:[(0,o.jsx)("sphereGeometry",{args:[p.headSize+.05,16,16,0,2*Math.PI,0,"short"===i?.4*Math.PI:"medium"===i?.5*Math.PI:.6*Math.PI]}),(0,o.jsx)("meshStandardMaterial",{color:s})]}),(0,o.jsxs)("mesh",{position:[0,1,0],children:[(0,o.jsx)("cylinderGeometry",{args:[p.shoulderWidth,p.hipWidth,.8,8]}),(0,o.jsx)("meshStandardMaterial",{color:l})]}),(0,o.jsxs)("mesh",{position:[-p.shoulderWidth-.15,1,0],rotation:[0,0,-.3],children:[(0,o.jsx)("cylinderGeometry",{args:[.08,.06,.7,8]}),(0,o.jsx)("meshStandardMaterial",{color:u})]}),(0,o.jsxs)("mesh",{position:[p.shoulderWidth+.15,1,0],rotation:[0,0,.3],children:[(0,o.jsx)("cylinderGeometry",{args:[.08,.06,.7,8]}),(0,o.jsx)("meshStandardMaterial",{color:u})]}),(0,o.jsxs)("mesh",{position:[-.15,.2,0],children:[(0,o.jsx)("cylinderGeometry",{args:[.1,.08,.8,8]}),(0,o.jsx)("meshStandardMaterial",{color:"#2c3e50"})]}),(0,o.jsxs)("mesh",{position:[.15,.2,0],children:[(0,o.jsx)("cylinderGeometry",{args:[.1,.08,.8,8]}),(0,o.jsx)("meshStandardMaterial",{color:"#2c3e50"})]})]})},i=e=>{const a=["#2c3e50","#8b4513","#daa520","#dc143c","#696969"];return{gender:e.gender||"female",skinTone:{caucasian:"light",asian:"pale",african:"dark",hispanic:"medium",middleEastern:"tan"}[e.ethnicity||"caucasian"]||"medium",hairColor:a[Math.floor(Math.random()*a.length)],hairStyle:["short","medium","long"][Math.floor(3*Math.random())],clothingColor:{professional:"#2c3e50",casual:"#3498db",creative:"#9b59b6",elegant:"#c0392b",athletic:"#27ae60"}[e.style||"casual"]||"#3498db"}}},86410:(e,a,t)=>{t.r(a),t.d(a,{default:()=>r});const r={}}}]);
//# sourceMappingURL=1117.5411b4f8.chunk.js.map