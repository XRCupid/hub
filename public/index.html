<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta
      name="description"
      content="Web site created using create-react-app"
    />
    <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" />
    <!--
      manifest.json provides metadata used when your web app is installed on a
      user's mobile device or desktop. See https://developers.google.com/web/fundamentals/web-app-manifest/
    -->
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    <!--
      Notice the use of %PUBLIC_URL% in the tags above.
      It will be replaced with the URL of the `public` folder during the build.
      Only files inside the `public` folder can be referenced from the HTML.

      Unlike "/favicon.ico" or "favicon.ico", "%PUBLIC_URL%/favicon.ico" will
      work correctly both with client-side routing and a non-root public URL.
      Learn how to configure a non-root public URL by running `npm run build`.
    -->
    <title>XRCupid Hub</title>
    <!-- Custom Cursors -->
    <link rel="stylesheet" href="%PUBLIC_URL%/assets/cursors.css" />
    <!-- TensorFlow.js warning suppression - MUST load first -->
    <script src="%PUBLIC_URL%/tfjs-suppress.js"></script>
    <!-- TensorFlow.js 1.7.4 - Compatible with ML5 0.12.2 -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.7.4/dist/tf.min.js"></script>
    <!-- ML5.js 0.12.2 - Proven working version -->
    <script src="https://unpkg.com/ml5@0.12.2/dist/ml5.min.js"></script>
    <!-- WebGazer 2.1.0 - Load AFTER our TF.js to preserve face tracking -->
    <script src="https://cdn.jsdelivr.net/npm/webgazer@2.1.0/dist/webgazer.min.js"></script>
    <script>
      console.log('[index.html] Script block executing...');
      
      // Initialize TensorFlow.js backend before other libraries use it
      if (typeof tf !== 'undefined') {
        console.log('[index.html] TensorFlow found, initializing...');
        tf.ready().then(() => {
          console.log('[index.html] TensorFlow.js backend ready:', tf.getBackend());
        }).catch(err => {
          console.error('[index.html] TensorFlow.js initialization error:', err);
        });
      } else {
        console.error('[index.html] TensorFlow not found!');
      }
      
      // Debug ML5 loading
      console.log('[index.html] ML5 version:', typeof ml5 !== 'undefined' ? ml5.version : 'Not loaded');
      
      // Debug WebGazer loading
      console.log('[index.html] WebGazer loaded:', typeof webgazer !== 'undefined');
      if (typeof webgazer !== 'undefined') {
        console.log('[index.html] WebGazer object:', webgazer);
        window.webgazer = webgazer; // Ensure it's on window object
      } else {
        console.error('[index.html] WebGazer failed to load!');
      }
      
      // Check again after a delay in case it loads asynchronously
      setTimeout(() => {
        console.log('[index.html] WebGazer check after 2s:', typeof webgazer !== 'undefined');
        if (typeof webgazer !== 'undefined' && !window.webgazer) {
          console.log('[index.html] Adding WebGazer to window object');
          window.webgazer = webgazer;
        }
      }, 2000);
      
      // Make ml5 globally available if it exists
      if (typeof ml5 !== 'undefined') {
        window.ml5 = ml5;
      }
      
      // Log when ML5 is ready
      document.addEventListener('DOMContentLoaded', () => {
        console.log('[index.html] DOM fully loaded');
        if (typeof ml5 !== 'undefined') {
          console.log('[index.html] ML5 is available:', ml5.version);
          console.log('[index.html] ML5 facemesh available:', typeof ml5.facemesh === 'function');
          console.log('[index.html] ML5 poseNet available:', typeof ml5.poseNet === 'function');
          
          // If poseNet is not available, try to debug why
          if (typeof ml5.poseNet !== 'function') {
            console.error('[index.html] ML5 poseNet is NOT available!');
            console.log('[index.html] Available ML5 methods:', Object.keys(ml5));
          } else {
            console.log('[index.html] ML5 poseNet is available!');
          }
        } else {
          console.error('[index.html] ML5 not available!');
        }
      });
    </script>
    <script type="importmap">
      { "imports":
        {
          "three": "https://cdn.jsdelivr.net/npm/three@0.170.0/build/three.module.js/+esm",
          "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.170.0/examples/jsm/"
        }
      }
    </script>
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
    <!--
      This HTML file is a template.
      If you open it directly in the browser, you will see an empty page.

      You can add webfonts, meta tags, or analytics to this file.
      The build step will place the bundled scripts into the <body> tag.

      To begin the development, run `npm start` or `yarn start`.
      To create a production bundle, use `npm run build` or `yarn build`.
    -->
    <script type="module">

    </script>
  </body>
</html>
